!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("heartstring",[],t):"object"==typeof exports?exports.heartstring=t():e.heartstring=t()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(3)),i=r(n(4));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function e(t){var n=t.audioContext,r=t.bpm,a=void 0===r?120:r,u=t.GameState,s=t.masterAudioNode,c=t.notes,l=void 0===c?[new o.default({audioContext:n,bpm:a,color:"red",frequency:88}),new o.default({audioContext:n,bpm:a,color:"orange",frequency:98.776}),new o.default({audioContext:n,bpm:a,color:"yellow",frequency:104.65}),new o.default({audioContext:n,bpm:a,color:"green",frequency:117.466}),new o.default({audioContext:n,bpm:a,color:"blue",frequency:131.85}),new o.default({audioContext:n,bpm:a,color:"indigo",frequency:139.692})]:c,f=t.noteTriggers,d=void 0===f?[new i.default({masterAudioNode:s,noteDuration:200,startDelay:0,position:0,triggerInterval:750}),new i.default({masterAudioNode:s,noteDuration:200,startDelay:0,position:-Math.PI/2,triggerInterval:500}),new i.default({masterAudioNode:s,noteDuration:200,startDelay:0,position:Math.PI/2,triggerInterval:1e3})]:f;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.audioContext=n,this.bpm=a,this.GameState=u,this.masterAudioNode=s,this.notes=l,this.noteTriggers=d}},function(e,t,n){"use strict";var o=s(n(2)),i=s(n(5)),r=s(n(0)),a=s(n(6)),u=s(n(7));function s(e){return e&&e.__esModule?e:{default:e}}window.HEART={GamePlay:o.default,GameState:i.default,Level:r.default,Note:a.default,UI:u.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(0));var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.GameState=t;var n=document.querySelector("canvas");n.width=window.innerWidth,n.height=window.innerHeight;var o=n.getContext("2d");this.cx=o.canvas.width/2,this.cy=o.canvas.height/2,this.canvas=n,this.ctx=o,this.rotation=0,this.oldMousePos=0,this.isMouseDown=!1;var r=new AudioContext;this.audioContext=r;var a=r.createGain();a.gain.value=.75,a.connect(r.destination),this.masterAudioNode=a,this.level=new i.default({audioContext:r,masterAudioNode:a})}return o(e,[{key:"init",value:function(){this.initControls(),this.initInterval()}},{key:"initControls",value:function(){var e=this;document.body.addEventListener("mousemove",this.handleMouseMove.bind(this)),document.body.addEventListener("mousedown",function(t){e.isMouseDown=!0,e.oldMousePos=t.clientX}),document.body.addEventListener("mouseup",function(t){e.isMouseDown=!1})}},{key:"initInterval",value:function(){this.level.noteTriggers.forEach(function(e){setTimeout(function(){e.start()},e.startDelay)})}},{key:"handleMouseMove",value:function(e){var t=this;this.isMouseDown&&(this.rotation+=.01*(this.oldMousePos-e.clientX),this.rotation>2*Math.PI&&(this.rotation=this.rotation%(2*Math.PI)),this.oldMousePos=e.clientX,this.level.noteTriggers.forEach(function(e){e.note=t.getNoteForPosition(e.position)}))}},{key:"getNoteForPosition",value:function(e){for(var t=2*Math.PI/this.level.notes.length,n=Math.floor((e+this.rotation)/t);n<0;)n=this.level.notes.length+n;return n>this.level.notes.length&&(n=Math.floor(n%this.level.notes.length)),this.level.notes[Math.abs(n)]}},{key:"drawNotes",value:function(){var e=this,t=2*Math.PI/this.level.notes.length;this.level.notes.forEach(function(n,o){var i=t*o,r=i+t;e.ctx.beginPath(),e.ctx.arc(e.cx,e.cy,e.cx/2,i-e.rotation,r-e.rotation),e.ctx.fillStyle=n.color,e.ctx.fill()})}},{key:"drawNoteTriggers",value:function(){var e=this;this.level.noteTriggers.forEach(function(t){e.ctx.beginPath(),e.ctx.arc(e.cx,e.cy,e.cx/2+20,t.position,t.position+.025),e.ctx.strokeStyle=t.color,e.ctx.stroke()})}},{key:"render",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawNotes(),this.drawNoteTriggers(),window.requestAnimationFrame(this.render.bind(this))}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=function(){function e(t){var n=t.audioContext,o=t.color,i=void 0===o?"rgba(255, 255, 255, 1)":o,r=t.frequency,a=void 0===r?110:r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.audioContext=n,this.color=i,this.frequency=a,this.audioNode=this.initAudioNode(n)}return o(e,[{key:"initAudioNode",value:function(e){var t=e.createOscillator();return t.type="square",t.frequency.setValueAtTime(this.frequency,e.currentTime),t.start(),t}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=function(){function e(t){var n=t.color,o=void 0===n?"white":n,i=t.masterAudioNode,r=t.noteDuration,a=void 0===r?100:r,u=t.position,s=void 0===u?0:u,c=t.startDelay,l=void 0===c?0:c,f=t.triggerInterval,d=void 0===f?250:f;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.color=o,this.masterAudioNode=i,this.note=null,this.noteDuration=a,this.position=s,this.startDelay=l,this.triggerInterval=d}return o(e,[{key:"start",value:function(){var e=this;setInterval(function(){if(null!==e.note){var t=Object.assign({},e.note);e.playNote(t),setTimeout(function(){e.stopNote(t)},e.noteDuration)}},this.triggerInterval)}},{key:"playNote",value:function(e){this.color="red",e.audioNode.connect(this.masterAudioNode)}},{key:"stopNote",value:function(e){this.color="white",e.audioNode.disconnect(this.masterAudioNode)}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.difficulty=1,this.level=null,this.playerName="neek",this.score=0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=function(){function e(t){var n=t.audioContext,o=t.color,i=void 0===o?"rgba(255, 255, 255, 1)":o,r=t.frequency,a=void 0===r?110:r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.audioContext=n,this.color=i,this.frequency=a,this.audioNode=this.initAudioNode(n)}return o(e,[{key:"initAudioNode",value:function(e){var t=e.createOscillator();return t.type="square",t.frequency.setValueAtTime(this.frequency,e.currentTime),t.start(),t}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.GameState=t,this.screens=document.querySelectorAll(".Screen"),this.buttons={quit:document.querySelectorAll('[data-nav="quit"]'),transitions:document.querySelectorAll("[data-target-screen]"),pause:document.querySelectorAll('[data-nav="pause"]')}}return o(e,[{key:"init",value:function(){this.initListenters(),this.setScreen("mainmenu"),this.updateScore(),this.updatePlayerName(),this.updateLevel()}},{key:"initListenters",value:function(){var e=this;Array.from(this.buttons.quit).forEach(function(e){e.addEventListener("click",function(){return window.close()})}),Array.from(this.buttons.pause).forEach(function(t){t.addEventListener("click",function(t){var n=e.GameState.GamePlay.audioContext;"running"===n.state?n.suspend().then(function(){t.target.innerHTML="Resume"}):"suspended"===n.state&&n.resume().then(function(){t.target.innerHTML="Pause"})})}),Array.from(this.buttons.transitions).forEach(function(t){t.addEventListener("click",e.initTransitions.bind(e))})}},{key:"initTransitions",value:function(e){this.setScreen(e.target.dataset.targetScreen)}},{key:"setScreen",value:function(e){Array.from(this.screens).forEach(function(t){t.dataset.screen===e?t.classList.add("active"):t.classList.remove("active")})}},{key:"updateScore",value:function(){document.querySelector('[data-ui="score"]').innerHTML=this.GameState.score}},{key:"updatePlayerName",value:function(){document.querySelector('[data-ui="playerName"]').innerHTML=this.GameState.playerName}},{key:"updateLevel",value:function(){document.querySelector('[data-ui="level"]').innerHTML=this.GameState.level}}]),e}();t.default=i}])});